<!-- exoâ€‘ranker.html  -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Exoâ€‘Ranker â€“ Explore Earthâ€‘like Exoplanets</title>

  <!-- â”€â”€â”€ simple glassâ€‘morphism theme â”€â”€â”€ -->
  <style>
    :root {
      --deepâ€‘navy:#0b0c10; --cosmicâ€‘blue:#232931; --stellarâ€‘cyan:#66fcf1; --glassâ€‘purple:#7f7fd5; --white:#fff;
    }
    *{boxâ€‘sizing:borderâ€‘box;padding:0;margin:0}
    body{minâ€‘height:100vh;fontâ€‘family:"Segoe UI",Arial,sansâ€‘serif;color:var(--white);
         background:linearâ€‘gradient(135deg,var(--deepâ€‘navy)70%,var(--cosmicâ€‘blue)100%);display:flex;flexâ€‘direction:column}
    header{display:flex;justifyâ€‘content:spaceâ€‘between;alignâ€‘items:center;padding:1rem 2rem;
           background:rgba(31,40,51,.6);backdropâ€‘filter:blur(8px)}
    .logo{fontâ€‘size:1.7rem;fontâ€‘weight:700;color:var(--stellarâ€‘cyan)}
    nav a{color:var(--white);textâ€‘decoration:none;fontâ€‘weight:600;marginâ€‘left:1rem}
    nav a:hover{textâ€‘decoration:underline}
    main{flex:1;margin:0 auto;maxâ€‘width:1280px;padding:2rem}

    h1 span{color:var(--stellarâ€‘cyan)}
    select{margin:.2rem .6rem;padding:.35rem;borderâ€‘radius:.4rem;background:#111;color:#fff;border:1px solid #666}
    #chart{height:620px;width:100%;marginâ€‘top:1.7rem;border:1px solid rgba(102,252,241,.08);borderâ€‘radius:1rem}
    #info{marginâ€‘top:1.5rem;padding:1rem;background:rgba(35,41,49,.45);border:1px solid rgba(102,252,241,.12);borderâ€‘radius:1rem;minâ€‘height:120px}
    #info h2{color:var(--stellarâ€‘cyan);marginâ€‘bottom:.5rem}
  </style>
</head>
<body>
  <header>
    <div class="logo">ğŸªÂ SkyQuestÂ /Â Exoâ€‘Ranker</div>
    <nav><a href="index.html" class="back">â†Â BackÂ Home</a></nav>
  </header>

  <main>
    <h1 style="fontâ€‘size:2.4rem;marginâ€‘bottom:.8rem">Exoâ€‘Ranker: <span>Which exoplanets look most Earthâ€‘like?</span></h1>
    <p>Select any two numerical parameters to plot the full, preâ€‘processed exoplanet catalogue (no API calls needed).</p>

    <div style="marginâ€‘top:1rem">
      <label for="xSel">Xâ€‘axis:</label>
      <select id="xSel"></select>
      <label for="ySel" style="marginâ€‘left:.8rem">Yâ€‘axis:</label>
      <select id="ySel"></select>
    </div>

    <div id="chart"></div>
    <div id="info"><em>Click a planet dot to read its 150â€‘word explainer.</em></div>
  </main>

  <!-- â”€â”€â”€ Plotly â”€â”€â”€ -->
  <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
  <script>
    // colours for up to 6 clusters
    const palette=['#66fcf1','#ffcc00','#ff6666','#9966ff','#00d084','#ff7eb3'];

    async function init(){
      const res=await fetch('processed_planets.json'); // <-- preâ€‘generated offline (has cluster & explanation)
      const data=await res.json();

      // populate dropdowns with numeric keys excluding cluster id
      const numericKeys=Object.keys(data[0]).filter(k=>typeof data[0][k]==='number'&&k!=='cluster');
      const xSel=document.getElementById('xSel');
      const ySel=document.getElementById('ySel');
      numericKeys.forEach(k=>{
        xSel.innerHTML+=`<option value="${k}">${k}</option>`;
        ySel.innerHTML+=`<option value="${k}">${k}</option>`;
      });
      xSel.value='pl_rade';
      ySel.value='pl_bmasse';

      function draw(){
        const x=xSel.value, y=ySel.value;
        const traces=[];
        const clusters=[...new Set(data.map(d=>d.cluster))].sort();
        clusters.forEach((c,i)=>{
          const pts=data.filter(d=>d.cluster===c);
          traces.push({
            x:pts.map(d=>d[x]),
            y:pts.map(d=>d[y]),
            text:pts.map(d=>d.pl_name),
            customdata:pts, // pass full obj for click handler
            mode:'markers',type:'scatter',name:`Cluster ${c}`,
            marker:{color:palette[i%palette.length],size:6,opacity:0.8}
          });
        });
        Plotly.newPlot('chart',traces,{
          title:`${x} vs ${y}`,
          xaxis:{title:x},yaxis:{title:y},template:'plotly_dark',legend:{orientation:'h'}
        });
      }

      xSel.onchange=draw; ySel.onchange=draw; draw();

      // click event to show explanation
      document.getElementById('chart').on('plotly_click',(ev)=>{
        const d=ev.points[0].customdata;
        const info=document.getElementById('info');
        info.innerHTML=`<h2>${d.pl_name}</h2><p><strong>Cluster:</strong> ${d.cluster} â€¢ <strong>Temp class:</strong> ${d.temp_class}</p><p>${d.explanation}</p>`;
      });
    }
    init();
  </script>
</body>
</html>
